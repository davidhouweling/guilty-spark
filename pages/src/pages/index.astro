---
import Layout from "../layouts/layout.astro";
import Button from "../components/button.astro";
import CommandCard from "../components/cards/command-card.astro";
import DemoCard from "../components/cards/demo-card.astro";
import FeatureCard from "../components/cards/feature-card.astro";
import StatCard from "../components/cards/stat-card.astro";
import SectionHeader from "../components/section-header.astro";
import { DISCORD_INVITE_URL } from "../constants";
import Container from "../components/container.astro";
import DiscordLogo from "../assets/discord-logo.png";
import MatchStatisticsIcon from "../components/icons/match-statistics-icon.astro";
import LiveTrackingIcon from "../components/icons/live-tracking-icon.astro";
import MapGeneratorIcon from "../components/icons/map-generator-icon.astro";
import PlayerLinkingIcon from "../components/icons/player-linking-icon.astro";
import CustomizableIcon from "../components/icons/customizable-icon.astro";
import NeatQueueLogoIcon from "../components/icons/neatqueue-logo-icon.astro";
import CombatRecordMedia from "../components/demo-media/combat-record-media.astro";
import NeatQueueMedia from "../components/demo-media/neatqueue-media.astro";
import LiveTrackerMedia from "../components/demo-media/live-tracker-media.astro";
import TestimonialCarousel from "../components/testimonials/testimonial-carousel.astro";
import styles from "../styles/index.module.css";

const heroStats = [
  { value: "33", label: "Servers" },
  { value: "2520+", label: "Series Tracked" },
  { value: "Free", label: "No cost to use" },
];

interface FeatureItem {
  title: string;
  description: string;
  Icon: typeof MapGeneratorIcon;
}

const featureItems: FeatureItem[] = [
  {
    title: "Match Statistics",
    description:
      "Comprehensive match analysis with K/D ratios, accuracy metrics, medal counts, and performance tracking across all game modes.",
    Icon: MatchStatisticsIcon,
  },
  {
    title: "Live Tracking",
    description:
      "Real-time match monitoring with automatic updates as games progress. Monitor your squad's performance live in Discord.",
    Icon: LiveTrackingIcon,
  },
  {
    title: "HCS Map Generator",
    description: "Generate tournament-ready HCS map with intelligent map and mode rotation for competitive play.",
    Icon: MapGeneratorIcon,
  },
  {
    title: "Player Linking",
    description: "Connect Discord users to Xbox gamertags for seamless stat tracking and automatic match detection.",
    Icon: PlayerLinkingIcon,
  },
  {
    title: "Customizable",
    description:
      "Configure channels, roles, and permissions. Customize how stats are displayed to match your server's needs.",
    Icon: CustomizableIcon,
  },
];

const commandItems = [
  { command: "/stats", description: "Display comprehensive match statistics for any player" },
  { command: "/servicerecord", description: "Access complete service record archives and competitive rank telemetry" },
  { command: "/connect", description: "Link your Discord account to your Xbox gamertag" },
  { command: "/track", description: "Start live tracking for an ongoing match" },
  { command: "/maps", description: "Generate HCS tournament map pools" },
  { command: "/setup", description: "Configure server settings and permissions" },
];

interface DemoItem {
  title: string;
  description: string;
  iconVariant: "default" | "image";
  Icon: typeof MatchStatisticsIcon;
  Media: typeof CombatRecordMedia;
  wide?: boolean;
}

const demoItems: DemoItem[] = [
  {
    title: "Combat Record Retrieval",
    description:
      "Access comprehensive statistical analysis for any completed series with a simple command invocation. Query efficiency ratios, accuracy matrices, commendation records, and performance metrics across all combat scenarios.",
    iconVariant: "default",
    Icon: MatchStatisticsIcon,
    Media: CombatRecordMedia,
  },
  {
    title: "Automated Queue Protocol",
    description:
      "Seamless integration with NeatQueue match coordination systems. Combat statistics are automatically compiled and transmitted upon engagement conclusion, with continuous tracking throughout active series.",
    iconVariant: "image",
    Icon: NeatQueueLogoIcon,
    Media: NeatQueueMedia,
  },
  {
    title: "Real-Time Engagement Monitoring",
    description:
      "Observe ongoing combat operations with periodic telemetry refresh cycles occurring every 180 seconds. Monitor engagement scores, combatant performance metrics, and series progression status through active surveillance with manual override controls available.",
    iconVariant: "default",
    Icon: LiveTrackingIcon,
    Media: LiveTrackerMedia,
    wide: true,
  },
];

interface CommunityTestimonial {
  text: string;
  who: string;
  discordServer: string;
  discordLink?: string;
}

const testimonialItems: CommunityTestimonial[] = [
  {
    text: "Guilty Spark has been nothing short of a game-changer for Clutch Academy. With our 4,000 members running customs, 8s, tournaments, and VOD reviews, monthly, we rely on systems that actually keep up with our community's pace. Guilty Spark elevates everything we do. \n\nThe integration with NeatQueue has transformed how we run matches. Stats are pulled instantly, series data is tracked seamlessly, and real-time performance metrics update in the background without us lifting a finger. Our players get accurate timelines of others in-queue games, our staff gets clean and reliable data for every series, and our competitive scene feels more professional than ever. \n\nBut what makes Guilty Spark special is not just the technology but the person behind it. The admin is genuinely one of the most dedicated and personable developers we've come across. He listens, he iterates, he fixes, he improves Spark consistently not because he has to, but because he cares about the Halo community and wants to build tools that help it grow. That attitude shows in every update he pushes and every feature he rolls out. He's a partner on the mission. \n\nWe're proud to use Guilty Spark at Clutch Academy and even prouder to support the people behind it.",
    who: "ClutCh",
    discordServer: "Clutch Academy",
    discordLink: "https://discord.gg/clutchacademy",
  },
  {
    text: "Our Dog Crew community (350+ ANZ members) absolutely loves Guilty Spark - it's made our games smoother, smarter, and way more engaging. Everyone from casuals to try-hards gets value out of it.",
    who: "Niz",
    discordServer: "Dog Crew",
  },
];
---

<Layout>
  <!-- Hero Section -->
  <section class={styles.heroSection}>
    <Container class={styles.heroContent}>
      <div class={styles.heroBadge}>
        <span class={styles.badgeBracket}>[</span>
        <span>Protocol Active</span>
        <span class={styles.badgeBracket}>]</span>
      </div>

      <h1 class={styles.heroTitle}>
        <span class={styles.titleLine}>Guilty</span>
        <span class={styles.titleLine}>Spark</span>
      </h1>

      <div class={styles.heroSubtitle}>Halo Infinite Combat Statistics Interface</div>

      <p class={styles.heroDescription}>
        Greetings, Reclaimer. I am 343 Guilty Spark, custodian of Installation 04's combat records. Access comprehensive
        telemetry analysis for your Halo Infinite custom games directly within Discord.
      </p>

      <div class={styles.heroButtons}>
        <Button href={DISCORD_INVITE_URL} variant="primary" target="_blank" icon={DiscordLogo}>Add to Discord</Button>
      </div>

      <!-- Stats Display -->
      <div class={styles.statsGrid}>
        {heroStats.map(({ value, label }) => <StatCard value={value} label={label} />)}
      </div>
    </Container>
  </section>

  <!-- Testimonials Section -->
  <section class={styles.testimonialsSection} aria-label="Community testimonials">
    <Container>
      <SectionHeader title="Community Intel" subtitle="Deployed Units Reporting In" />
      <TestimonialCarousel items={testimonialItems} autoRotateMs={5000} />
    </Container>
  </section>

  <!-- Demo Section -->
  <section class={styles.demoSection}>
    <Container>
      <SectionHeader title="Operational Demonstrations" subtitle="Monitor Protocol Systems in Active Deployment" />
      <div class={styles.demoGrid}>
        {
          demoItems.map(({ title, description, iconVariant, Icon, Media, wide }) => (
            <DemoCard title={title} description={description} iconVariant={iconVariant} wide={wide}>
              <Icon slot="icon" />
              <Media slot="media" />
            </DemoCard>
          ))
        }
      </div>
    </Container>
  </section>

  <!-- Features Section -->
  <section id="features" class={styles.featuresSection}>
    <Container>
      <SectionHeader title="Capabilities" subtitle="Advanced Combat Analysis Systems" />

      <div class={styles.featuresGrid}>
        {
          featureItems.map(({ title, description, Icon }) => (
            <FeatureCard title={title} description={description}>
              <Icon slot="icon" />
            </FeatureCard>
          ))
        }
      </div>
    </Container>
  </section>

  <!-- Commands Section -->
  <section id="commands" class={styles.commandsSection}>
    <Container>
      <SectionHeader title="Command Interface" subtitle="Slash Command Protocols" />

      <div class={styles.commandsGrid}>
        {commandItems.map(({ command, description }) => <CommandCard command={command} description={description} />)}
      </div>
    </Container>
  </section>

  <!-- CTA Section -->
  <section class={styles.ctaSection}>
    <Container>
      <div class={styles.ctaContent}>
        <h2 class={styles.ctaTitle}>Ready to Deploy?</h2>
        <p class={styles.ctaText}>Integrate combat statistics into your Discord server now.</p>
        <Button href={DISCORD_INVITE_URL} variant="primary" size="large" target="_blank"> Activate Protocol </Button>
      </div>
    </Container>
  </section>
</Layout>
